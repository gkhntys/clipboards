[{"id":"8f8eeb18.2579d8","type":"debug","z":"f64fbb0a.a3b318","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1270,"y":360,"wires":[]},{"id":"16d73b8f.bef8f4","type":"function","z":"f64fbb0a.a3b318","name":"Changing Payload Format","func":"let exclude = [\"V1\",\"V2\",\"V3\",\"C1\",\"C2\",\"C3\",\"WT\",\"WE\"]\n\nlet data = global.get( \"azure_data\" );\n\nlet res =   {\n  \"deviceId\": \"RPG-EN-4\",\n  \"key\": \"87IPVKcdiTDggXlspjcLuvhBuQ8/00yXFBnGz+dTye4=\",\n  \"protocol\": \"amqp\",\n  \"data\": {\n    \"Version\": \"1.0\",\n    \"SourceType\": \"INTEGRATED\",\n    \"Source\": \"REPG\",\n    \"UniqueId\": \"\",\n    \"Data\": {\n      \"Messages\": []\n    }\n  }\n}\n\n\nfor( let i of Object.entries( data ) ) {\n    \n    if( !exclude.includes(  i[0] )   &&  i[1] !== undefined ) {    \n   \n\n\n\n      res.data.Data.Messages.push(   {\n                          \"Timestamp\": new Date(),\n                          \"Parameters\": [\n                                {\n                                  \"Key\": i[0],\n                                  \"Value\": String( i[1] )\n                                }\n                                        ]\n                                  }\n                        \n                            )\n  \n    \n    } // end of if  \n   \n    \n} // end of loop\n\n\n\n\nmsg.payload = res;\nreturn msg;","outputs":1,"noerr":0,"x":890,"y":340,"wires":[["8f8eeb18.2579d8","d68c6625.2fdd38"]]},{"id":"d2d80b4f.acea08","type":"inject","z":"f64fbb0a.a3b318","name":"1 Minute","topic":"","payload":"","payloadType":"date","repeat":"59","crontab":"","once":false,"onceDelay":0.1,"x":680,"y":360,"wires":[["16d73b8f.bef8f4"]]},{"id":"d68c6625.2fdd38","type":"azureiothub","z":"f64fbb0a.a3b318","name":"Azure IoT Hub","protocol":"amqp","x":1100,"y":460,"wires":[["7a8e2847.9e8578"]]},{"id":"7a8e2847.9e8578","type":"debug","z":"f64fbb0a.a3b318","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1290,"y":460,"wires":[]},{"id":"8696c2e7.a65f9","type":"inject","z":"f64fbb0a.a3b318","name":"1 Minute","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":false,"onceDelay":0.1,"x":660,"y":560,"wires":[["66cdab61.f3f244"]]},{"id":"50f65d5a.8c9d44","type":"debug","z":"f64fbb0a.a3b318","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1270,"y":560,"wires":[]},{"id":"66cdab61.f3f244","type":"function","z":"f64fbb0a.a3b318","name":"Changing Payload Format","func":"let exclude = [\"T1\",\"T2\",\"T3\",\"T4\",\"T5\",\"T6\",\"P1\",\"P2\",\"R1\",\"R2\",\"R4\",\"Hz\", \"P3\", \"P4\" ,\"SC1\" ,\"SC2\" ,\"SC3\" ,\"SC4\" ,\"SC5\" ,\"SC6\" ,\"SC7\"];\nlet data = global.get( \"azure_data\" );\n\nlet res =   {\n  \"deviceId\": \"RPG-EN-4\",\n  \"key\": \"87IPVKcdiTDggXlspjcLuvhBuQ8/00yXFBnGz+dTye4=\",\n  \"protocol\": \"amqp\",\n  \"data\": {\n    \"Version\": \"1.0\",\n    \"SourceType\": \"INTEGRATED\",\n    \"Source\": \"REPG\",\n    \"UniqueId\": \"\",\n    \"Data\": {\n      \"Messages\": []\n    }\n  }\n}\n\n\nfor( let i of Object.entries( data ) ) {\n    \n    if( !exclude.includes(  i[0] )   &&  i[1] !== undefined ) {    \n   \n\n\n\n      res.data.Data.Messages.push(   {\n                          \"Timestamp\": new Date(),\n                          \"Parameters\": [\n                                {\n                                  \"Key\": i[0],\n                                  \"Value\": String( i[1] )\n                                }\n                                        ]\n                                  }\n                        \n                            )\n  \n    \n    } // end of if  \n   \n    \n} // end of loop\n\n\n\n\nmsg.payload = res;\nreturn msg;","outputs":1,"noerr":0,"x":910,"y":560,"wires":[["d68c6625.2fdd38","50f65d5a.8c9d44"]]},{"id":"bf5877a4.ec44b8","type":"debug","z":"f64fbb0a.a3b318","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1170,"y":140,"wires":[]},{"id":"e819ead0.96acc8","type":"inject","z":"f64fbb0a.a3b318","name":"","topic":"","payload":"azure_data","payloadType":"global","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":990,"y":140,"wires":[["bf5877a4.ec44b8"]]}]