[{"id":"478e1c6.6dc5de4","type":"inject","z":"c519760c.a6a818","name":"1 Minute","topic":"","payload":"","payloadType":"date","repeat":"59","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":240,"wires":[["5a7c7ebf.8a9ec"]]},{"id":"1aee5199.6a4a3e","type":"azureiothub","z":"c519760c.a6a818","name":"Azure IoT Hub","protocol":"amqp","x":560,"y":340,"wires":[["fdcc95e6.8cb778"]]},{"id":"d391ac7d.20e15","type":"debug","z":"c519760c.a6a818","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":730,"y":240,"wires":[]},{"id":"fdcc95e6.8cb778","type":"debug","z":"c519760c.a6a818","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":340,"wires":[]},{"id":"7cc62155.54656","type":"inject","z":"c519760c.a6a818","name":"1 Hour","topic":"","payload":"","payloadType":"date","repeat":"3600","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":440,"wires":[["cb1da56.f71ff58"]]},{"id":"6bb68e37.38193","type":"debug","z":"c519760c.a6a818","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":730,"y":440,"wires":[]},{"id":"5a7c7ebf.8a9ec","type":"function","z":"c519760c.a6a818","name":"Changing Payload Format","func":"let exclude = [\"V1\",\"V2\",\"V3\",\"C1\",\"C2\",\"C3\",\"WT\",\"WE\"]\n\nlet data = global.get( \"azure_data\" );\n\nlet res =   {\n  \"deviceId\": \"RPG-SN-Pilot-2\",\n  \"key\": \"pc8CgqVHPap4h6jrS+zGG4wNWECT6ifKQhKf31RGso4=\",\n  \"protocol\": \"amqp\",\n  \"data\": {\n    \"Version\": \"1.0\",\n    \"SourceType\": \"INTEGRATED\",\n    \"Source\": \"REPG\",\n    \"UniqueId\": \"\",\n    \"Data\": {\n      \"Messages\": []\n    }\n  }\n}\n\n\nfor( let i of Object.entries( data ) ) {\n    \n    if( !exclude.includes(  i[0] )   &&  i[1] !== undefined ) {    \n   \n\n\n\n      res.data.Data.Messages.push(   {\n                          \"Timestamp\": new Date(),\n                          \"Parameters\": [\n                                {\n                                  \"Key\": i[0],\n                                  \"Value\": String( i[1] )\n                                }\n                                        ]\n                                  }\n                        \n                            )\n  \n    \n    } // end of if  \n   \n    \n} // end of loop\n\n\n\n\nmsg.payload = res;\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":220,"wires":[["d391ac7d.20e15","1aee5199.6a4a3e"]]},{"id":"cb1da56.f71ff58","type":"function","z":"c519760c.a6a818","name":"Changing Payload Format","func":"let exclude = [\"T1\",\"T2\",\"T3\",\"T4\",\"T5\",\"T6\",\"P1\",\"P2\",\"R1\",\"R2\",\"R4\",\"Hz\", \"P3\", \"P4\"];\nlet data = global.get( \"azure_data\" );\n\nlet res =   {\n  \"deviceId\": \"RPG-SN-Pilot-2\",\n  \"key\": \"pc8CgqVHPap4h6jrS+zGG4wNWECT6ifKQhKf31RGso4=\",\n  \"protocol\": \"amqp\",\n  \"data\": {\n    \"Version\": \"1.0\",\n    \"SourceType\": \"INTEGRATED\",\n    \"Source\": \"REPG\",\n    \"UniqueId\": \"\",\n    \"Data\": {\n      \"Messages\": []\n    }\n  }\n}\n\n\nfor( let i of Object.entries( data ) ) {\n    \n    if( !exclude.includes(  i[0] )   &&  i[1] !== undefined ) {    \n   \n\n\n\n      res.data.Data.Messages.push(   {\n                          \"Timestamp\": new Date(),\n                          \"Parameters\": [\n                                {\n                                  \"Key\": i[0],\n                                  \"Value\": String( i[1] )\n                                }\n                                        ]\n                                  }\n                        \n                            )\n  \n    \n    } // end of if  \n   \n    \n} // end of loop\n\n\n\n\nmsg.payload = res;\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":440,"wires":[["1aee5199.6a4a3e","6bb68e37.38193"]]}]